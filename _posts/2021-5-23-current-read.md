---
layout: post
title: 不同隔离级别下的乐观锁有区别吗?
---

主要内容
1.不同隔离级别下的乐观锁有区别吗?(可重复读和读已提交)
2.当前读和锁等待的必然联系
3.当前读有哪些?

# 当前读和锁等待的必然联系
因为当前读必须要读最新版本,如果此时该行数据上有事物尚未提交,则当前事务必须等待锁,这样才能保证读取到最新的记录.

# 一个无法更新的现象
Q: 事务隔离级别是可重复读。现在，我要把所有“字段 c 和 id 值相等的行”的 c 值清零，但是却发现了一个“诡异”的、改不掉的情况

# Q:可重复读 下 乐观锁 还会有效吗? // 工作中遇到疑问

我看leader把select和udpate放一个事务里，这个乐观锁有点尴尬。

如果是可重复读的隔离级别，那么对当前事务来说，只有version = version的情况啊，这个是横成立的。 即使其他事务对version进行了修改，这个事务也是看不到的吧?

A: 发现可重复读的情况下， 乐观锁也是没问题。因为update是当前读。乐观锁在可重复读下的使用

## Q: 乐观锁在可重复读下的使用的过程?
// 附录1

# 参考资料
1.[08 | 事务到底是隔离的还是不隔离的？](https://time.geekbang.org/column/article/70562)